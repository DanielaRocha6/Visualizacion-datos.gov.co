(window["webpackJsonpdatos.gov"]=window["webpackJsonpdatos.gov"]||[]).push([[0],{15:function(e,t,n){e.exports=n(31)},20:function(e,t,n){},22:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(2),o=n.n(a),r=n(4),i=n.n(r),c=(n(20),n(12)),s=n(5),l=n.n(s),u=n(11),d=n(6),h=n(7),m=n(9),v=n(8),f=n(3),b=n(10),p=(n(22),n(14)),g=n.n(p),y=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(v.a)(t).call(this,e))).refDiv=o.a.createRef(),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(){this.loadNavio()}},{key:"loadNavio",value:function(){var e=g()(this.refDiv.current);e.data(this.props.data),e.addAllAttribs(),e.updateCallback((function(e){return console.log("selected in Navio: ",e.length)}))}},{key:"render",value:function(){return console.log(this.props.data),o.a.createElement("div",{ref:this.refDiv})}}]),t}(o.a.Component),k=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(v.a)(t).call(this,e))).url="",n.c=0,n.state={dataNavio:[],history:[]},n.handleSubmit=n.handleSubmit.bind(Object(f.a)(n)),n.handleClick=n.handleClick.bind(Object(f.a)(n)),n.obtenerHistory=n.obtenerHistory.bind(Object(f.a)(n)),n.deleteHistory=n.deleteHistory.bind(Object(f.a)(n)),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"change",value:function(e){this.url=e.target.value}},{key:"doReq",value:function(e){var t=this;return new Promise((function(e,n){Object(u.a)(l.a.mark((function a(){var o,r;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch("".concat(t.url,"?$limit=1000&$offset=").concat(1e3*t.c));case 3:return o=a.sent,a.next=6,o.json();case 6:0!==(r=a.sent).length?e({termino:!1,data:r}):e({termino:!0,data:[]}),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),n(a.t0);case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()}))}},{key:"deleteHistory",value:function(){fetch("/historico",{method:"DELETE",credentials:"same-origin"}).then((function(e){console.log(e),e.json()})).then((function(e){console.log("Se borr\xf3 :) ".concat(e),"https://www.datos.gov.co/resource/jhpq-24h2.json")})),this.obtenerHistory()}},{key:"obtenerHistory",value:function(){var e=this,t=[];fetch("/historico",{method:"GET",credentials:"same-origin"}).then((function(e){return e.json()})).then((function(n){for(var a=0;a<n.length;a++){var o=String(n[a].url);console.log(n[a].url),t.push(o),e.setState({history:t})}})),console.log(this.state.history)}},{key:"handleClick",value:function(e,t){this.url=t,this.handleSubmit(e)}},{key:"handleSubmit",value:function(e){var t=this;Object(u.a)(l.a.mark((function n(){var a,r,s,u;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=!1,e.preventDefault(),!t.url.includes(".co")&&!t.url.includes(".com")){n.next=22;break}alert("Pronto tra\xe9remos tus datos de ".concat(t.url)),r=JSON.stringify({url:t.url}),console.log("buenasssss",r),fetch("/historico/url",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({url:t.url})}),s=[];case 8:if(a){n.next=18;break}return i.a.render(o.a.createElement("h2",null," Se han cargado ",t.c," p\xe1ginas del dataset solicitado"),document.getElementById("cargando")),n.next=12,t.doReq(t.c);case 12:u=n.sent,a=u.termino,s=[].concat(Object(c.a)(s),Object(c.a)(u.data)),t.c++,n.next=8;break;case 18:a&&(t.obtenerHistory(),i.a.render(o.a.createElement("h2",null," Se han cargado ",s.length," entradas"),document.getElementById("cargando")),t.c=0),t.setState({dataNavio:s}),n.next=23;break;case 22:alert("No es una direcci\xf3n valida");case 23:case"end":return n.stop()}}),n)})))()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"centerDiv"},o.a.createElement("div",null,o.a.createElement("h1",{align:"center"},"Visualizaci\xf3n datos de datos.gov.co"),o.a.createElement("form",{className:"form-group",onSubmit:this.handleSubmit},o.a.createElement("input",{placeholder:"Ingresa una url",type:"text",onChange:this.change.bind(this)}),o.a.createElement("br",null),o.a.createElement("input",{id:"submit",type:"submit",value:"CONSULTAR"})),o.a.createElement("div",{id:"cargando"})),o.a.createElement("div",null,this.state.history.map((function(t){return o.a.createElement("button",{onClick:function(n){return e.handleClick(n,"".concat(t))}},t,o.a.createElement("br",null))}))),o.a.createElement("div",{id:"navio"},this.state.dataNavio&&o.a.createElement(y,{data:this.state.dataNavio})))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[15,1,2]]]);
//# sourceMappingURL=main.66ef86ce.chunk.js.map